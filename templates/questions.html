<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>الأسئلة المحفوظة</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <style>
        body { direction: rtl; font-family: 'Tajawal', sans-serif; background-color: #f7fafc; }
        .gradient-button { background: linear-gradient(90deg, #3b82f6 0%, #2563eb 100%); transition: all 0.3s ease; }
        .gradient-button:hover { transform: translateY(-1px); }
    </style>
</head>
<body class="min-h-screen py-12 px-4">
    <div class="container max-w-4xl mx-auto">
        
        <div class="text-center mb-12">
            <h1 class="text-4xl font-extrabold text-gray-800 mb-2">📚 بنك الأسئلة المحفوظة</h1>
            <p class="text-lg text-gray-500">اختر مجموعة لبدء جلسة تقييم.</p>
        </div>

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="{% if category == 'error' %}bg-red-100 border-red-400 text-red-700{% else %}bg-green-100 border-green-400 text-green-700{% endif %} border-l-4 p-4 mb-6 rounded-md" role="alert">
                        <p class="font-bold">{{ message }}</p>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <div class="space-y-8">
            {% if question_sets %}
                {% for q_set in question_sets %}
                    <div class="bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-200">
                        <div class="p-6 border-b bg-gray-50 flex justify-between items-center">
                            <div>
                                <h2 class="text-xl font-bold text-gray-800">مجموعة أسئلة</h2>
                                <p class="text-sm text-gray-500">
                                    تم الحفظ بتاريخ: {{ q_set.timestamp | strftime if q_set.timestamp else 'N/A' }}
                                    <span class="mx-2">|</span>
                                    عدد الأسئلة: {{ q_set.questions | length }}
                                </p>
                            </div>
                            
                            <!-- **************************************** -->
                            <!-- *** THIS IS THE BUTTON YOU NEED TO ADD *** -->
                            <!-- **************************************** -->
                            <div>
                                <a href="{{ url_for('evaluate_set', set_id=q_set._id) }}" 
                                   class="gradient-button text-white font-bold py-2 px-5 rounded-lg shadow-md hover:shadow-lg transition-all">
                                    بدء التقييم
                                </a>
                            </div>
                            
                        </div>
                        
                        <div class="p-6">
                            <ul class="space-y-4">
                                {% for qa in q_set.questions %}
                                    <li class="border-b pb-3 last:border-b-0">
                                        <p class="font-semibold text-gray-700">
                                            <span class="text-blue-600">سؤال {{ loop.index }}:</span> {{ qa.question }}
                                        </p>
                                        <p class="text-sm text-gray-600 pl-6">
                                            <strong class="text-green-600">جواب:</strong> {{ qa.answer }}
                                        </p>
                                    </li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <div class="text-center bg-white rounded-lg shadow-md p-10">
                    <h3 class="text-xl font-semibold text-gray-700">لم يتم حفظ أي أسئلة بعد.</h3>
                    <p class="text-gray-500 mt-2">ابدأ بإنشاء مجموعتك الأولى!</p>
                </div>
            {% endif %}
        </div>

        <div class="mt-12 text-center">
            <a href="{{ url_for('index') }}" class="inline-block bg-gray-700 text-white font-bold py-3 px-8 rounded-lg shadow-lg hover:bg-gray-800 transition-colors">
                العودة وإنشاء أسئلة جديدة
            </a>
        </div>
    </div>
</body>
</html>